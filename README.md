# VK_DIS_WH_BOT
Публичная версия приватного репозитория с "затёртыми" токенами, ключами API и URL'ами вебхуков

Бот создавался с целью фильтрации флуда в чате университетской ученической группы. А именно: пересылать определённые, важные, сообщения из беседы vk.com в специальный сервер discord с последующей классификацией.
А именно, сообщение отправлялось в один из каналов: "важная информация", "литература", "напоминаня" и "мемы". Также сообщение с тегом даты добавлялось в общий google calendar.

Бот бесплатно хостится на https://heroku.com

### Детали реализации:
- Бот имеет асинхронный метод использующий VK Long Poll API, который вызывается каждый раз, когда приходит сообщение в беседе. Если сообщение содержит специальный тег ('/DIS_MAJOR', '/DIS_BOOKS' и тд) то он заносится в список-буфер. Сообщение представляет собой словарь, подобный json'у. Если же сообщение содержит дату, записанную в специальном формате, то текст сообщения добавляется в общий google calendar.
- Далее бот проверяет каждые n секунд размер списка-буфера, если он не нулевой, то извлекает последний элемент, обрабатывает его (например, если это сообщение было переслано, то распаковывает все его вложения и тп), далее создает json для запроса вебхука discord и отправляет сообщение соответсвующее url'y вебхука в словаре textTags_chaneURLs.

Если участник беседы хочет сообщить важную информацию, например дату зачёта. то его сообщение будет выглядеть: "/DIS_MAJOR {25.12.21} зачёт по ТФКП в 13:00", далее в канала "важная информация" добавится сообщение, а также событие занесётся в google calendar:

![demonstration](https://github.com/1azar/VK_DIS_WH_BOT/blob/master/demo_1.jpg)
![demonstration](https://github.com/1azar/VK_DIS_WH_BOT/blob/master/demo_2.jpg)

### Демонстрация работы:
